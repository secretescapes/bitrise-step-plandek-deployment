title: |-
  Plandek - deployment
summary: |
  Enables you to track and visualize build and deployment events within Plandek's metrics and dashboards.
description: |
  Wrapper implementing the Plandek /deployment POST API. Used to complete a deployment within Plandek for a given release cycle.
  More details can be found here: https://api.plandek.com/deployments/v1/ui/
website: https://github.com/secretescapes/bitrise-step-plandek-deployment
source_code_url: https://github.com/secretescapes/bitrise-step-plandek-deployment
support_url: https://github.com/secretescapes/bitrise-step-plandek-deployment/issues

type_tags:
  - utility

is_always_run: true
is_skippable: true

toolkit:
  bash:
    entry_file: step.sh

deps:
  brew:
  - name: jq
  - name: curl
  apt_get:
  - name: jq
  - name: curl

inputs:
  - api_token:
    opts:
      title: "API token"
      summary: |
        Plandek API token.
      description: |
        Plandek API token.
      is_required: true
      is_sensitive: true
      is_expand: true
  - client_key:
    opts:
      title: "Client key"
      summary: |
        Unique identifier of your instance.
      description: |
        Unique identifier of your instance.
      is_required: true
  - pipeline: $BITRISE_APP_TITLE
    opts:
      title: "Pipeline"
      summary: |
        Typically corresponds to the name of your pipeline, workflow, repo, or service under which builds are compiled.
      description: |
        Typically corresponds to the name of your pipeline, workflow, repo, or service under which builds are compiled.
        If you use the same name pipelines across your organization, we recommend appending additional information to
        your pipeline name (e.g. repo name) to make it easier to understand your data.
      is_required: true
      is_expand: true
  - build:
    opts:
      title: "Build"
      summary: |
        Build identifier in your build tool. Typically the version being deployed (e.g. Svc B 10.2.1).
      description: |
        Build identifier in your build tool. Typically the version being deployed (e.g. Svc B 10.2.1).
      is_required: true
  - commits: $BITRISE_GIT_COMMIT
    opts:
      title: "Commits"
      summary: |
        The full commit hash(es) of the release being deployed.
      description: |
        The full commit hash(es) of the release being deployed.
      is_required: true
  - calculate_commits_in_build: "false"
    opts:
      title: Network Logs
      summary: |
        If true, Plandek will use the information in your deployment to work out what commits were included in the release
        (see below for explanation). If false, you must specify the commits in the commits field.
      description: |
        If true, Plandek will use the information in your deployment to work out what commits were included in the release
        (see below for explanation). If false, you must specify the commits in the commits field.
      is_required: true
      value_options:
      - "true"
      - "false"
  - branch_name: $BITRISE_GIT_BRANCH
    opts:
      title: "Branch name"
      summary: |
        Name of the branch being deployed.
      description: |
        Name of the branch being deployed.
      is_expand: true
